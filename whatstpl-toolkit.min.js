!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.WhatsTplToolkit=e():t.WhatsTplToolkit=e()}(this,function(){return function(t){var e={};function n(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:r})},n.r=function(t){Object.defineProperty(t,"__esModule",{value:!0})},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n.w={},n(n.s=4)}([function(t,e,n){"use strict";function r(t){if("/"==t)return t;var n=t.replace(/\\/g,"/").lastIndexOf("/");return n<0||"/"==t?".":n==t.length-1?r(t.substring(0,n)):t.substring(0,n).replace(/\/|\\/g,e.Separator)}function o(t,e){void 0===e&&(e="");var n=r(t),o="."==n&&null==t.match(/^\.[\/\\]/)?t:t.substring(n.length+1);if(e){var i=o.lastIndexOf(e);o=i>=0?o.substring(0,i):o}return o}function i(t){for(var n=t.split(/\/|\\/),r=0;r<n.length;r++)".."==n[r]?(n.splice(r-1,2),r-=2):"."==n[r]&&(n.splice(r,1),r-=1);return n.join(e.Separator)}function u(){return e.IsBrowser?location.protocol+"//"+location.host+r(location.pathname):process.cwd()}function a(t){return"/"==t[0]||/^[a-zA-Z]:[\/\\]/.test(t)}Object.defineProperty(e,"__esModule",{value:!0}),e.IsBrowser="object"==typeof window&&"function"==typeof XMLHttpRequest,e.Separator=e.IsBrowser?"/":"win32"==process.platform?"\\":"/",e.escape=function(t){return String(t).replace(/<\/?[^>]*>/g,"")},e.dirname=r,e.basename=o,e.extname=function(t){var e=o(t),n=e.lastIndexOf(".");return n>=0?e.substring(n):""},e.normalizePath=i,e.getCwd=u,e.isAbsPath=a,e.getAbsPath=function(t){if(!a(t)){var n=u();t=n+("/"==n[n.length-1]?"":e.Separator)+t}return i(t)},e.getObjectValues=function(t){var e=[];for(var n in t)t.hasOwnProperty(n)&&e.push(t[n]);return e},e.getFunctionBodyOffset=function(t){var e=t.toString(),n=e.indexOf("{")+1,r=e.slice(0,n).split("\n"),o="\n"==e[n],i=o?0:r[r.length-1].indexOf("{")+2;return{line:o?r.length:r.length-1,column:i}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(2),o=function(t){function e(e,n,r,o){var i=t.call(this,e)||this;return i.filename=n,i.line=r,i.column=o,i}return r.__extends(e,t),e}(SyntaxError);e.UnclosedTagError=o},function(t,e,n){"use strict";n.r(e),n.d(e,"__extends",function(){return o}),n.d(e,"__assign",function(){return i}),n.d(e,"__rest",function(){return u}),n.d(e,"__decorate",function(){return a}),n.d(e,"__param",function(){return s}),n.d(e,"__metadata",function(){return c}),n.d(e,"__awaiter",function(){return l}),n.d(e,"__generator",function(){return f}),n.d(e,"__exportStar",function(){return p}),n.d(e,"__values",function(){return h}),n.d(e,"__read",function(){return d}),n.d(e,"__spread",function(){return g}),n.d(e,"__await",function(){return y}),n.d(e,"__asyncGenerator",function(){return m}),n.d(e,"__asyncDelegator",function(){return v}),n.d(e,"__asyncValues",function(){return b}),n.d(e,"__makeTemplateObject",function(){return x}),n.d(e,"__importStar",function(){return _}),n.d(e,"__importDefault",function(){return w});
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
var r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};function o(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var i=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t};function u(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&(n[r[o]]=t[r[o]])}return n}function a(t,e,n,r){var o,i=arguments.length,u=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(u=(i<3?o(u):i>3?o(e,n,u):o(e,n))||u);return i>3&&u&&Object.defineProperty(e,n,u),u}function s(t,e){return function(n,r){e(n,r,t)}}function c(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}function l(t,e,n,r){return new(n||(n=Promise))(function(o,i){function u(t){try{s(r.next(t))}catch(t){i(t)}}function a(t){try{s(r.throw(t))}catch(t){i(t)}}function s(t){t.done?o(t.value):new n(function(e){e(t.value)}).then(u,a)}s((r=r.apply(t,e||[])).next())})}function f(t,e){var n,r,o,i,u={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;u;)try{if(n=1,r&&(o=r[2&i[0]?"return":i[0]?"throw":"next"])&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[0,o.value]),i[0]){case 0:case 1:o=i;break;case 4:return u.label++,{value:i[1],done:!1};case 5:u.label++,r=i[1],i=[0];continue;case 7:i=u.ops.pop(),u.trys.pop();continue;default:if(!(o=(o=u.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){u=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){u.label=i[1];break}if(6===i[0]&&u.label<o[1]){u.label=o[1],o=i;break}if(o&&u.label<o[2]){u.label=o[2],u.ops.push(i);break}o[2]&&u.ops.pop(),u.trys.pop();continue}i=e.call(t,u)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}}function p(t,e){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}function h(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}}function d(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),u=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)u.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return u}function g(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(d(arguments[e]));return t}function y(t){return this instanceof y?(this.v=t,this):new y(t)}function m(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,o=n.apply(t,e||[]),i=[];return r={},u("next"),u("throw"),u("return"),r[Symbol.asyncIterator]=function(){return this},r;function u(t){o[t]&&(r[t]=function(e){return new Promise(function(n,r){i.push([t,e,n,r])>1||a(t,e)})})}function a(t,e){try{(n=o[t](e)).value instanceof y?Promise.resolve(n.value.v).then(s,c):l(i[0][2],n)}catch(t){l(i[0][3],t)}var n}function s(t){a("next",t)}function c(t){a("throw",t)}function l(t,e){t(e),i.shift(),i.length&&a(i[0][0],i[0][1])}}function v(t){var e,n;return e={},r("next"),r("throw",function(t){throw t}),r("return"),e[Symbol.iterator]=function(){return this},e;function r(r,o){e[r]=t[r]?function(e){return(n=!n)?{value:y(t[r](e)),done:"return"===r}:o?o(e):e}:o}}function b(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,n=t[Symbol.asyncIterator];return n?n.call(t):(t=h(t),e={},r("next"),r("throw"),r("return"),e[Symbol.asyncIterator]=function(){return this},e);function r(n){e[n]=t[n]&&function(e){return new Promise(function(r,o){(function(t,e,n,r){Promise.resolve(r).then(function(e){t({value:e,done:n})},e)})(r,o,(e=t[n](e)).done,e.value)})}}}function x(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function _(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function w(t){return t&&t.__esModule?t:{default:t}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(1),o=n(0),i=/([0-9a-zA-Z:\-]+)\s*=\s*|([0-9a-zA-Z:\-]+)\s*/,u=function(){function t(e){void 0===e&&(e="");var n=this;this.listeners={},this.outputTags=t.OutputTags,this.blockTags=t.BlockTags,this.filename=e?o.getAbsPath(e):"undefined",this.renewRegExp(),this.on("block",function(t){var e=t.attributes;if("block"==t.tag)n.blockTags.push(e.name.value),n.renewRegExp();else if("import"==t.tag&&e.target&&e.target.value){var r=e.target.value.split(/,\s*/);for(var o in r){var i=r[o].split(/\s+as\s+/);r[o]=i[1]||i[0]}n.blockTags=n.blockTags.concat(r),n.renewRegExp()}})}return t.prototype.renewRegExp=function(){var t=this.blockTags.join("|"),e="\x3c!--(.*?)--\x3e|\x3c!--(.*)|("+this.outputTags.join("|")+"){(.+?)}|<("+t+")[\\s|\\/|>]|<\\/("+t+")>";this.regexp=new RegExp(e)},t.prototype.on=function(t,e){this.listeners[t]||(this.listeners[t]=[]),this.listeners[t].push(e)},t.prototype.emit=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(!this.listeners[t]||!this.listeners[t].length)return!1;for(var r=0,o=this.listeners[t];r<o.length;r++){o[r].apply(void 0,e)}return!0},t.prototype.parse=function(t){var e={tag:"root",type:"root",line:1,column:1,contents:[],closed:!1};return this.html=t.trimRight().replace(/\r\n|\r/g,"\n"),this.parseHtml(this.html,1,1,e),e},t.prototype.getLine=function(t,e){for(var n,r;;){var o=t.indexOf("\n");if(n=(o>=0?t.substring(0,o):t).trimRight(),r=o>=0?t.substring(o+1):"",n||!r)break;e+=1,t=r}return{lineStr:n,left:r,line:e}},t.prototype.attachTextNode=function(t,e,n,r,o,i){void 0===i&&(i=!1);var u={type:"text",line:e,column:n,contents:r?t.substring(0,r):t+"\n",closed:!0};(i||u.contents.trimLeft())&&(o.push(u),this.emit("text",u))},t.prototype.parseHtml=function(e,n,o,i){void 0===o&&(o=1);var u=this.getLine(e,n),a=u.lineStr,s=a.match(this.regexp),c=i.contents;if(e=u.left,n=u.line,s)if(s[1]&&"script"!=i.tag){s.index&&(this.attachTextNode(a,n,o,s.index,c),o+=s.index);var l=a.substring(s.index+s[0].length),f={type:"comment",line:n,column:o,contents:s[0],closed:!1};c.push(f),this.emit("comment",f),l?(e=l+"\n"+e,o+=s[0].length):(f.contents+="\n",n+=1,o=1)}else if(s[2]&&"script"!=i.tag){s.index&&(this.attachTextNode(a,n,o,s.index,c),o+=s.index);f={type:"comment",line:n,column:o,contents:a.substring(s.index),closed:!1};n+=1,o=1;var p=this.parseComment(e,n,o,f);c.push(f),this.emit("comment",f),e=p.left,n=p.line,o=p.column}else if(s[3]&&s[4]){s.index&&(this.attachTextNode(a,n,o,s.index,c,"!"!=s[3]),o+=s.index),o+=2;var h={tag:s[3],type:"var",line:n,column:o,contents:s[4],closed:!0};c.push(h),this.emit("var",h);var d=s.index+s[4].length+3;(l=a.substring(d)).trimRight()?(e=l+(e?"\n"+e:""),o+=s[4].length+1):(n+=1,o=1)}else if(s[5]&&"script"!=i.tag){s.index&&(this.attachTextNode(a,n,o,s.index,c),o+=s.index);var g=a[(d=s.index+s[0].length)-1],y="/"==g||">"==g,m={tag:s[5],type:"block",line:n,column:o,attributes:{},contents:[],closed:!1};if(y&&(d-=1),!(l=a.substring(d))&&e){o=1;var v=this.getLine(e,n);v.lineStr&&(l=v.lineStr,e=v.left)}if(!l)throw new r.UnclosedTagError("unclosed tag",this.filename,n,o);e=l+(e?"\n"+e:""),o+=s[0].length,y&&(o-=1);p=this.applyAttr(e,n,o,m.attributes);m.closed=p.blockClosed,p.left&&!m.closed&&(p=this.parseHtml(p.left,p.line,p.column,m)),c.push(m),this.emit("block",m),e=p.left,n=p.line,o=p.column}else if(s[6]&&s[6]==i.tag){s.index&&"script"!=i.tag&&this.attachTextNode(a,n,o,s.index,c),i.closed=!0;d=s.index+s[0].length;(l=a.substring(d))?(e=l+(e?"\n"+e:""),o+=d):(n+=1,o=1)}else this.attachTextNode(a,n,o,NaN,c),n+=1,o=1;else{if("script"==i.tag&&i.attributes.engine&&i.attributes.engine.value==t.EngineName){var b={type:"snippet",line:n,column:o,contents:a+"\n",closed:!0};c.push(b),this.emit("snippet",b)}else this.attachTextNode(a,n,o,NaN,c);n+=1,o=1}return e&&!i.closed?this.parseHtml(e,n,o,i):(i.closed=!0,{line:n,column:o,left:e})},t.prototype.applyAttr=function(t,e,n,o){var u,a,s=this.getLine(t,e),c=s.lineStr,l=c.trimLeft()[0],f="/"==l||">"==l?null:c.match(i);if(e=s.line,t=s.left,!f){var p=c.indexOf(">");if(-1===p)throw new r.UnclosedTagError("unclosed tag",this.filename,e,n);n+=p+1;var h=c.substring(p+1);return h?t=h+"\n"+t:(e+=1,n=1),{line:e,column:n,left:t,blockClosed:"/"==l}}var d,g=!0;if(f[1]){var y=f.index+f[0].length,m=c[y],v=void 0;(g="'"==m||'"'==m)&&(y+=1),g?v=c.indexOf(m,y):-1===(v=c.indexOf("/",y))&&(v=c.indexOf(">",y)),u=f[1],a=-1===v?"":c.substring(y,v),d=c.substring(v+1),n+=y}else f[2]&&(u=a=f[2].trim(),d=c.substring(f.index+f[0].length),n+=f.index);return o[u]={name:u,value:a,line:e,column:n},d?(t=d+"\n"+t,n+=f[1]?a.length:f[0].length,n+=g?1:0):(e+=1,n=1),this.applyAttr(t,e,n,o)},t.prototype.parseComment=function(t,e,n,r){var o=this.getLine(t,e),i=o.lineStr,u=i&&i.match(/-->/);if(e=o.line,t=o.left,i&&(r.contents+="\n"),!u)return r.contents+=i,e+=1,n=1,t?this.parseComment(t,e,n,r):{line:e,column:n,left:t};u.index&&(r.contents+=i.substring(0,u.index)),r.contents+=u[0],r.closed=!0,n+=u.index+3;var a=i.substring(n);return a?t=a+"\n"+t:(e+=1,n=1),{line:e,column:n,left:t}},t.EngineName="whatstpl",t.BlockTags=["layout","import","export","block","if","else-if","else","switch","case","default","for","while","do","continue","break","script"],t.OutputTags=["!","@","#"],t}();e.Parser=u},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(2);r.__exportStar(n(1),e),r.__exportStar(n(3),e),r.__exportStar(n(0),e)}])});
//# sourceMappingURL=whatstpl-toolkit.min.js.map